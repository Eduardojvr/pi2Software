#:import hex kivy.utils.get_color_from_hex
#: import SwapTransition kivy.uix.screenmanager.SwapTransition


<Gerenciador>:
	name: 'ScreenManager'
	BoxLayout:
		orientation: 'horizontal'
		columns: 4
		
       
		ScreenManager:
			transition: SwapTransition()
			TelaInicial:
			TelaAfinacao: 
           
<TelaInicial>:
	name: 'telaInicial'
	pos_hint:  {'x': 0, 'y': 0}
	
	# Cinza claro
	my_color: hex('#E0E0E0')

	canvas:
        Color:
            rgba: self.my_color
        Rectangle:
            pos: self.pos
            size: self.size
	
	Menu:
	
	BoxLayout:
		orientation: 'vertical'
		columns: 4
		
		padding: [-10, -80, 10, 50]
		spacing: 15
			
        BoxLayout:
            orientation: 'horizontal'            
            padding: [icon_battery.x - 25 , -10, 56, -20]
            Label:
                id: battery
		        text: root.battery_level()
			    pos_hint:  {'x': 0 , 'y': 0}

		    Image:
	            id: icon_battery
			    pos_hint:  {'x': 0, 'y': 0}
			    source: 'assets/bateria100.png'
            

			
		Image:
			id: logo_icon
			pos_hint:  {'x': 0.1, 'y': -.5}
			source: 'assets/guitar_icon_black.png'
			size: 256, 256
			padding: [0, 0, 0, 20]
		
		

		Button:
			text: 'Afinar'
			pos_hint:  {'x': 0.35, 'y': 1}
			size_hint: 0.45, 0.3
			on_release: root.parent.current = 'telaAfinacao'
			background_normal: ''
    		
			# Azul
			background_color: hex('#0075CE')
			
		
		Button:
			pos_hint:  {'x': 0.35, 'y': 0.3}
			size_hint: 0.45, 0.3
			text: 'Afrouxar cordas'
			background_normal: ''
    		
			# Azul
			background_color: hex('#0075CE')
		
		Button:
			pos_hint:  {'x': 0.35, 'y': 0.3}
			size_hint: 0.45, 0.3
			text: 'Tensionar cordas'
			background_normal: ''
    		
			# Azul
			background_color: hex('#0075CE')

<TelaAfinacao>:
	name: 'telaAfinacao'
	
	# Cinza escuro
	my_color: hex('#404040')

	canvas:
        Color:
            rgba: self.my_color
        Rectangle:
            pos: self.pos
            size: self.size

	BoxLayout:
		orientation: 'vertical'
		columns: 4
		
		BoxLayout:
			orientation: 'horizontal'
						
         			
			Button:
				text: ""
				background_color: (0,0,0,0)
				on_release: root.confirm_return()
				size_hint: (.2,9)
				pos: (0,root.y)
				Image:
					center_x: self.parent.center_x -30
        			center_y: self.parent.center_y
					source:"../img/voltar.png"
					
					
			ProgressBar:
				id: progress_bar
				size_hint: .6, 1
				value: 0
				on_value: root.show_progress_bar(*args)
				
				canvas:
					BorderImage:
						border: (8, 8, 8, 8)
						pos: self.x, self.center_y - 8
						size: self.width, 16
						source: 'assets/progress_bar_bg.png'
					
					BorderImage:
						border: [int(min(self.width * (self.value / float(self.max)) if self.max else 0, 8))] * 4
						pos: self.x, self.center_y - 8
						size: self.width * (self.value / float(self.max)) if self.max else 0, 16
						source: 'assets/progress_bar.jpg'

			Label:
				id: progress
				size_hint: .2, 1
		ToneLayout:	
			size_hint: 1, 2
		
		Label:
			id: frequency
			text: '0'

		Slider:
			id: barra_db
			cursor_image: 'assets/cursor_verde.png'
			cursor_size: (100, 40)
			background_horizontal: 'assets/bg.png'
			value: root.frequency_range()
			range: (-330, 330)
			step: 1

			on_value: root.show_tuning_data(*args)
			on_value: root.change_db_cursor(*args)
			
			on_touch_down: root.disable_touch_event()
			on_touch_move: root.disable_touch_event()
			on_touch_up: root.disable_touch_event()

<Menu>:
	name: 'menu'
	size_hint_x: 0.15

	canvas:
		Color:
			
			# Cinza médio
			rgba: hex('#808080')
		Rectangle:
			pos: self.pos
			size: self.size
	
	FloatLayout:
		orientation: 'vertical'

		MenuButton:
			pos_hint: {'y': .6}
			size_hint_y: .6
			on_press: root.change_theme()
			
			Image:
				id: theme_icon
				source: 'assets/light_bulb_icon_black.png'
				allow_stretch: True
				keep_ratio: True
				x: self.parent.x
				y: self.parent.y
				center: self.parent.center
		
		MenuButton:
			pos_hint: {'y': .8}
			size_hint_y: .8
			on_release: root.rasp_shutdown()
			Image:
				id: shutdown_icon
				source: 'assets/shutdown_icon_black.png'
				allow_stretch: True
				keep_ratio: True
				center: self.parent.center
				x: self.parent.x
				y: self.parent.y

<MenuButton>:
	canvas:
		Color:
			
			# Cinza médio
			rgba: hex('#808080')
		Rectangle:
			pos: self.pos
			size: self.size
